# vrchat-auto-block

当检测到有好友删除了你时，自动将该用户拉黑的Python脚本。

## 功能特性

- 🔄 自动轮询检测好友列表变化
- 🚫 自动拉黑删除你的用户  
- 🔐 完整支持两步验证(2FA)
- 🎯 支持会话复用，避免重复验证
- ✅ 智能二次验证机制（使用 isFriend API）
- 📝 详细的日志记录
- 💾 本地缓存好友数据
- ⚙️ 可配置的轮询间隔
- 🛡️ 错误重试机制
- 📊 支持大量好友列表（自动分页获取）

## 二次验证

为了避免误报删除，脚本采用了二次验证机制：

- 🔍 **初次检测**: 通过好友列表对比发现可能被删除的用户
- ✅ **isFriend 验证**: 使用 VRChat API 的 `isFriend` 标识逐个验证
- 🎯 **精准确认**: 只有在 `isFriend` 为 false 时才确认删除
- 📊 **完整性检查**: 验证好友列表获取的完整性
- ⚡ **快速响应**: 避免重新获取整个好友列表的开销

## 会话复用功能

为了避免每次启动都需要输入2FA验证码，脚本支持会话复用：

- 🔐 **自动保存会话**: 首次认证成功后，会话信息会自动保存到 `session.json`
- ⚡ **快速启动**: 下次启动时会自动使用保存的会话，无需重新输入验证码
- 🕒 **智能过期**: 会话文件会自动检查有效期（默认7天）
- 🔄 **自动刷新**: 如果检测到会话失效，会自动进行重新认证
- 🗑️ **手动清除**: 可以通过启动选项清除保存的会话

### 清除会话

如果需要重新认证，可以：

1. 启动程序时选择清除会话
2. 手动删除 `session.json` 文件
3. 程序检测到认证问题时会自动清除无效会话

## 安装依赖

### 方法1：自动安装（推荐）

```bash
pip install -r requirements.txt
```

### 方法2：手动安装

```bash
pip install requests
```

## 使用方法

### 方法1：直接运行

```bash
python main.py
```

按提示输入你的VRChat用户名和密码即可。

### 方法2：使用配置文件

1. 复制配置文件模板：

```bash
copy config.example.json config.json
```

2. 编辑 `config.json` 填写你的VRChat账号信息

3. 修改 `main.py` 使用配置文件（需要额外代码修改）

## 配置选项

- `poll_interval`: 轮询间隔（秒），默认60秒
- `max_retries`: API请求最大重试次数，默认3次

## 文件说明

- `main.py`: 主程序文件
- `requirements.txt`: Python依赖包列表
- `config.example.json`: 配置文件示例
- `friends_cache.json`: 好友数据缓存（自动生成）
- `vrchat_auto_block.log`: 程序运行日志（自动生成）

## 工作原理

1. 使用VRChat API进行身份认证（支持2FA）
2. 获取当前好友列表并建立缓存
3. 定期轮询好友列表，对比缓存检测变化
4. 发现有用户不再是好友时，自动调用拉黑API
5. 记录所有操作到日志文件

## 注意事项

⚠️ **重要提醒：**

- 此脚本使用VRChat官方API，请遵守VRChat服务条款
- 建议设置合理的轮询间隔，避免频繁请求被限制
- 首次运行会建立好友缓存，不会立即拉黑任何人
- 程序会在检测到删除后立即拉黑，请谨慎使用
- 如果启用了2FA，请确保你能正常使用验证器应用或接收邮箱验证码

## 安全建议

- 不要将包含密码的配置文件提交到版本控制系统
- 建议使用VRChat的应用程序密码功能（如果支持）
- 定期检查日志文件，确保程序正常工作
- 2FA验证码具有时效性，请及时输入

## 故障排除

### 认证失败

- 检查用户名和密码是否正确
- 如果启用了2FA，确保验证码输入正确且在有效期内
- 检查网络连接是否正常

### API请求失败

- 检查网络连接
- 确认VRChat服务状态
- 降低轮询频率避免被限制

### 程序崩溃

- 查看日志文件获取详细错误信息
- 确保Python版本兼容
- 检查依赖包是否正确安装

## 免责声明

此脚本仅供学习和个人使用。使用此脚本可能违反VRChat的服务条款，使用者需自行承担风险。作者不对因使用此脚本导致的账号封禁或其他后果负责。

## 许可证

MIT License
